# AI德州扑克大模型对战Demo

基于PyPokerEngine和302.AI的德州扑克AI对战演示项目。支持多个大模型同时对战，包括Claude、Gemini、GPT、Grok、DeepSeek、Qwen、GLM、Kimi等。

## 功能特性

- 🤖 **多模型支持**: 支持8种主流大模型同时对战
- 🎮 **完整游戏**: 基于PyPokerEngine的完整德州扑克游戏逻辑
- 🧠 **智能决策**: AI通过分析游戏状态和对手行为做出决策
- 📊 **详细统计**: 显示游戏结果和AI决策统计
- 🎨 **友好界面**: 彩色终端输出，清晰的游戏进程显示
- 🔧 **灵活配置**: 可自定义游戏参数和参与模型

## 支持的AI模型

| 模型 | 提供商 | 模型名称 | 上下文长度 | 温度 |
|------|--------|----------|------------|------|
| Claude | Anthropic | claude-sonnet-4-5-20250929 | 200,000 | 0.7 |
| Gemini | Google | gemini-2.5-pro | 1,000,000 | 0.7 |
| GPT | OpenAI | gpt-5-chat-latest | 400,000 | 0.7 |
| Grok | xAI | grok-4-0709 | 256,000 | 0.7 |
| DeepSeek | DeepSeek | deepseek-chat | 4,096 | 0.7 |
| Qwen | Alibaba | qwen3-max-2025-09-23 | 258,048 | 0.7 |
| GLM | Zhipu | glm-4.6 | 200,000 | 0.7 |
| Kimi | Moonshot | kimi-k2-0905-preview | 256,000 | 0.7 |

## 安装和使用

### 1. 环境准备

```bash
# 克隆项目
git clone <repository-url>
cd ai_texas_holdem

# 安装依赖
pip install -r requirements.txt
```

### 2. 配置API密钥

1. 复制环境配置文件：
```bash
cp env_example.txt .env
```

2. 编辑`.env`文件，添加您的302.AI API密钥：
```
API_302_KEY=your_302_ai_api_key_here
```

### 3. 获取302.AI API密钥

1. 访问 [302.AI](https://302.ai) 平台
2. 注册并登录账户
3. 在控制台中创建API密钥
4. 将密钥添加到`.env`文件中

### 4. 运行Demo

```bash
python demo.py
```

## 使用说明

### 游戏流程

1. **选择模型**: 从8个支持的AI模型中选择至少2个参与对战
2. **配置游戏**: 设置游戏参数（轮数、初始筹码、盲注等）
3. **开始对战**: AI模型自动进行德州扑克对战
4. **查看结果**: 显示最终排名和详细统计

### 游戏配置

- **最大轮数**: 游戏进行的轮数（默认10轮）
- **初始筹码**: 每个玩家的起始筹码（默认1000）
- **小盲注**: 小盲注金额（默认10）

### AI决策机制

每个AI玩家在做决策时会考虑：

1. **手牌强度**: 分析当前手牌的强度和潜力
2. **公共牌**: 考虑公共牌对手牌的影响
3. **对手行为**: 分析对手的行动历史和模式
4. **底池赔率**: 计算跟注的性价比
5. **筹码管理**: 考虑当前筹码深度和风险

## 项目结构

```
ai_texas_holdem/
├── demo.py                 # 主演示程序
├── ai_poker_player.py      # AI扑克玩家类
├── ai_client.py           # 302.AI API客户端
├── game_state_analyzer.py # 游戏状态分析器
├── config.py              # 配置文件
├── requirements.txt       # Python依赖
├── env_example.txt        # 环境配置模板
└── README.md             # 项目说明
```

## 核心组件

### AIPokerPlayer
基于PyPokerEngine的BasePokerPlayer实现的AI玩家类，负责：
- 接收游戏状态信息
- 调用大模型API获取决策
- 执行游戏行动
- 记录决策历史

### AI302Client
302.AI API的封装客户端，提供：
- 多模型支持
- 统一的API调用接口
- 错误处理和重试机制
- 决策结果解析

### GameStateAnalyzer
游戏状态分析器，负责：
- 解析PyPokerEngine的游戏状态
- 提取关键信息（手牌、公共牌、对手行为等）
- 格式化信息供AI模型分析
- 计算手牌强度和行动模式

## 示例输出

```
╔══════════════════════════════════════════════════════════════╗
║                    AI德州扑克大模型对战Demo                      ║
║                  基于PyPokerEngine + 302.AI                   ║
╚══════════════════════════════════════════════════════════════╝

支持的AI模型:
 1. claude     - claude-3-5-sonnet-20241022
 2. gemini     - gemini-1.5-pro-002
 3. gpt        - gpt-4o-mini

请选择参与对战的AI模型 (输入数字，用空格分隔，至少2个):
选择模型 (例如: 1 2 3): 1 2 3

============================================================
开始AI德州扑克对战!
参与玩家: CLAUDE_AI, GEMINI_AI, GPT_AI
============================================================

[CLAUDE_AI] 游戏状态:
  手牌: A♠ K♥
  公共牌: 无
  轮次: preflop
  我的筹码: 990
  需跟注: 20

[CLAUDE_AI] AI决策: raise, 金额: 60
```

## 注意事项

1. **API费用**: 使用大模型API会产生费用，请注意控制使用量
2. **网络连接**: 需要稳定的网络连接访问302.AI API
3. **响应时间**: AI决策需要时间，游戏进程可能较慢
4. **模型差异**: 不同模型的决策风格和能力可能存在差异

## 故障排除

### 常见问题

1. **API密钥错误**
   - 检查`.env`文件中的API密钥是否正确
   - 确认在302.AI平台中密钥状态正常

2. **网络连接问题**
   - 检查网络连接
   - 确认能够访问302.AI API

3. **模型响应异常**
   - 某些模型可能暂时不可用
   - 程序会自动使用备用策略继续游戏

### 调试模式

程序默认开启调试模式，提供丰富的日志输出，包括：

#### 🎯 AI决策流程日志
- 完整的游戏状态分析
- 发送给模型的详细prompt
- 模型的原始响应内容
- JSON解析过程和结果
- 最终决策的处理流程

#### 📊 游戏状态显示
- 手牌和公共牌的可视化显示
- 底池赔率计算
- 对手行动历史和模式分析
- 筹码状态和变化追踪

#### 🎨 美化输出
- 使用emoji和分割线增强可读性
- 不同类型信息的颜色区分
- 结构化的信息展示

#### 🔧 技术调试信息
- 模型配置参数
- API调用状态
- 错误处理和备用策略
- 性能统计信息

如需关闭调试模式，可在创建AIPokerPlayer时设置`debug=False`。

#### 测试增强日志功能

```bash
# 运行增强日志测试
python test_enhanced_logging.py
```

## 扩展开发

### 添加新的AI模型

1. 在`config.py`中的`SUPPORTED_MODELS`添加新模型配置
2. 确保302.AI平台支持该模型
3. 测试API调用是否正常

### 自定义决策策略

可以修改`ai_client.py`中的`_build_poker_prompt`方法来调整AI的决策提示词，或者在`ai_poker_player.py`中实现自定义的备用策略。

### 游戏规则扩展

基于PyPokerEngine的强大功能，可以扩展支持其他扑克变体，如奥马哈、七张牌等。

## 许可证

本项目基于MIT许可证开源。

## 贡献

欢迎提交Issue和Pull Request来改进项目！
